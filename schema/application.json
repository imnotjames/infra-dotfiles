{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Application configuration",
  "type": "object",
  "properties": {
    "application": { "$ref": "#/definitions/application" }
  },
  "definitions": {
    "application": {
      "type": "object",
      "properties": {
        "stack": { "$ref": "#/definitions/stack" },
        "addons": { "$ref": "#/definitions/addons" },
        "parameters": { "$ref": "#/definitions/parameters" },
        "environments": { "$ref": "#/definitions/environments" }
      },
      "additionalProperties": false
    },
    "stack": {
      "type": "string"
    },
    "addons": {
      "type": "array",
      "items": {
        "anyOf": [
          { "$ref": "#/definitions/addon" },
          {
            "type": "string",
            "description": "String of the type of the addon.  Defaults are assigned to all other fields."
          }
        ]
      }
    },
    "addon": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string"
        },
        "as": {
          "type": "string"
        },
        "identifier": {
          "type": "string"
        },
        "parameters": { "$ref": "#/definitions/parameters" }
      },
      "additionalProperties": false
    },
    "parameters": {
      "type": "object"
    },
    "environments": {
      "type": "object",
      "propertyNames": {
        "enum": [
          "production",
          "canary",
          "development",
          "loadtest"
        ]
      },
      "additionalProperties": {
        "$ref": "#/definitions/environment"
      }
    },
    "environment": {
      "type": "object",
      "properties": {
        "addons": { "$ref": "#/definitions/addons" },
        "parameters": { "$ref": "#/definitions/parameters" }
      },
      "additionalProperties": false
    }
  }
}
